<html>
<head>
  <title>Web Site Staging Service for Git Repositories</title>
  <style type="text/css">
  pre {
     background: #FFC;
     border: 1px dotted #333;
     border-radius: 3px;
     padding: 2px;
  }
  </style>
</head>
<body style="font-family: sans-serif; width: 1000px; margin: 20px auto;">
<h1>Web Site Staging Service for Git Repositories</h1>

<p>The web site staging service is managed by <kbd>.asf.yaml</kbd> in git repositories.</p>

<h2>Web site staging instructions:</h2>
<p>To enable staging of web sites, an entry can be added to the site repository's .asf.yaml file:</p>
<p>As an example, take the imaginary <kbd>yourproject-website.git</kbd> with an <kbd>.asf.yaml</kbd> file containing the following entry:</p>
<pre>staging:<br/>    profile: foo</pre>
<p>this would stage the current branch at <a href="https://yourproject-foo.staged.apache.org">https://yourproject-foo.staged.apache.org</a> (meaning you can have multiple staging profiles and thus multiple branches staged for preview).<br/>
One can also omit the profile and stage directly at <a href="https://yourproject.staged.apache.org">https://yourproject.staged.apache.org</a> as such:</p>
<pre>staging: true</pre>
<h3>Preventing branch-override on cloning branch:</h3>
<p>One can set a protection on multitenancy, by specifying a whoami setting. If this does not match the current branch, no checkout/update will be made. Thus, one can have, on asf-site branch:</p>
<pre>staging:<br/>  profile: test<br/>  whoami: asf-site</pre>
<p>When cloning that branch to a new branch, let's call it asf-site-copy, the staging web site server will notice that `whoami` does not match asf-site-copy, and ignore that branch until such a point where the whoami is updated to match.</p>
<hr/>
<p>For questions, feedback or other inquiries, please contact users@infra.apache.org</p>
</body>
</html>
